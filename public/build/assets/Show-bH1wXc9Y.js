import{r as j,S as N,j as e,J as t,q as f,a as w}from"./app-CeL17lsE.js";import{C as y}from"./CommentForm-DrNKHlPp.js";import{B as k}from"./Base-COiCnIHa.js";import"./TextInput-DIzGoC6r.js";import"./InputLabel-CgbnObFB.js";function b({comment:s,auth:r,postId:u}){const n=u||s.post_id,[i,o]=j.useState(!1),[m,h]=j.useState(!1),{data:a,setData:l,post:c,processing:x,reset:p}=N({content:"",parent_id:s.id??""}),g=d=>{d.preventDefault(),c(route("comments.store",{post:n}),{preserveScroll:!0,onSuccess:v=>{p("content"),h(!1),o(!0),v.props.comment&&(s.replies=[...s.replies||[],v.props.comment],s.replies_count=(s.replies_count||0)+1)}})};return e.jsx("div",{className:"pb-4 last:pb-0",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(t,{href:route("users.show",s.user.username),className:"flex-shrink-0",children:e.jsx("div",{className:"avatar",children:e.jsx("div",{className:"w-10 rounded-full",children:e.jsx("img",{src:s.user.avatar||`https://ui-avatars.com/api/?name=${encodeURIComponent(s.user.name)}`,alt:s.user.name})})})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(t,{href:route("users.show",s.user.username),className:"font-semibold hover:text-primary hover:underline",children:s.user.name}),e.jsx("span",{className:"text-sm opacity-70",children:s.created_at})]}),e.jsx("p",{className:"mt-1",children:s.content}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm",children:[e.jsxs("button",{className:`flex items-center gap-1 hover:text-primary ${s.has_liked?"text-primary":""}`,children:[e.jsx("svg",{className:"w-4 h-4",fill:s.has_liked?"currentColor":"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 10h4.764a2 2 0 011.789 2.894l-3.5 7A2 2 0 0115.263 21h-4.017c-.163 0-.326-.02-.485-.06L7 20m7-10V5a2 2 0 00-2-2h-.095c-.5 0-.905.405-.905.905 0 .714-.211 1.412-.608 2.006L7 11v9m7-10h-2M7 20H5a2 2 0 01-2-2v-6a2 2 0 012-2h2.5"})}),e.jsx("span",{children:s.likes_count||0})]}),s.replies&&s.replies.length>0&&e.jsxs("button",{onClick:()=>o(!i),className:"flex items-center gap-1 hover:text-primary",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})}),e.jsxs("span",{children:[s.replies_count||s.replies.length," réponses"]})]}),r.user&&e.jsx("button",{onClick:()=>h(!m),className:"hover:text-primary hover:underline",children:"Répondre"})]}),m&&r.user&&e.jsxs("form",{className:"mt-4 flex gap-3",onSubmit:g,children:[e.jsx("div",{className:"avatar flex-shrink-0",children:e.jsx("div",{className:"w-8 rounded-full",children:e.jsx("img",{src:r.user.avatar||`https://ui-avatars.com/api/?name=${encodeURIComponent(r.user.name)}`,alt:r.user.name})})}),e.jsxs("div",{className:"flex-1 flex gap-2",children:[e.jsx("input",{type:"text",name:"content",value:a.content,onChange:d=>l("content",d.target.value),placeholder:"Écrire une réponse...",className:"input input-bordered input-sm w-full",required:!0}),e.jsx("button",{type:"submit",className:"btn btn-primary btn-sm",disabled:x,children:x?"Envoi...":"Envoyer"})]})]}),i&&s.replies&&s.replies.length>0&&e.jsx("div",{className:"mt-3 pl-4 border-l-2 border-base-200 space-y-3",children:s.replies.map(d=>e.jsx(b,{comment:d,auth:r,postId:n},d.id))})]})]})})}function R({post:s}){var o,m,h;const[r,u]=j.useState(!1),{auth:n}=f().props,i=r?s.comments:s.comments.slice(0,3);return e.jsxs(k,{children:[e.jsxs(w,{children:[e.jsx("title",{children:s.title}),e.jsx("meta",{name:"description",content:s.meta})]}),e.jsx("div",{className:"container mx-auto px-4 py-8 ",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-8 ",children:[e.jsxs("div",{className:"lg:w-2/3 ",children:[e.jsxs("article",{className:"card  shadow-md p-6 mb-8 bg-base-200",children:[e.jsxs("header",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs(t,{href:route("users.show",s.author.username),className:"flex items-center gap-3 group",children:[e.jsx("div",{className:"avatar",children:e.jsx("div",{className:"w-12 rounded-full",children:e.jsx("img",{src:s.author.avatar||`https://ui-avatars.com/api/?name=${s.author.name}`,alt:s.author.name})})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold group-hover:text-primary transition",children:s.author.name}),e.jsx("time",{dateTime:s.published_at.datetime,className:"text-sm text-gray-500",children:s.published_at.formatted})]})]}),e.jsx("div",{className:"flex gap-2",children:(o=s.tags)==null?void 0:o.map(a=>e.jsxs(t,{className:"badge badge-outline hover:badge-primary transition",children:["#",a.name]},a.id))})]}),e.jsx("h1",{className:"text-3xl font-bold mb-4",children:s.title})]}),s.image&&e.jsx("figure",{className:"mb-6 rounded-lg overflow-hidden",children:e.jsx("img",{src:s.image,alt:s.title,className:"w-full h-auto max-h-[32rem] object-cover"})}),s.video_url&&e.jsx("div",{className:"aspect-w-16 aspect-h-9 mb-6",children:e.jsx("iframe",{src:s.video_url,className:"w-full h-[32rem] rounded-lg",allowFullScreen:!0})}),e.jsx("div",{className:"prose max-w-none mb-8  shadow-lg shadow-base-100 px-4 py-4",dangerouslySetInnerHTML:{__html:s.content}}),e.jsxs("div",{className:"flex items-center justify-between border-t border-b border-base-300 py-4 my-6",children:[e.jsxs("div",{className:"flex items-center gap-6 ",children:[e.jsxs("button",{className:"btn btn-ghost btn-sm gap-2 bg-base-100",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 10h4.764a2 2 0 011.789 2.894l-3.5 7A2 2 0 0115.263 21h-4.017c-.163 0-.326-.02-.485-.06L7 20m7-10V5a2 2 0 00-2-2h-.095c-.5 0-.905.405-.905.905 0 .714-.211 1.412-.608 2.006L7 11v9m7-10h-2M7 20H5a2 2 0 01-2-2v-6a2 2 0 012-2h2.5"})}),e.jsx("span",{children:s.stats.likes_count})]}),e.jsxs("button",{className:"btn btn-ghost btn-sm gap-2 bg-base-100",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),e.jsx("span",{children:s.stats.comments_count})]}),s.tags&&s.tags.length>0&&e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:(m=s.tags)==null?void 0:m.map(a=>{const l=["badge-primary","badge-secondary","badge-accent","badge-info","badge-success","badge-warning","badge-error","badge-ghost"],c=Math.abs(a.name.split("").reduce((x,p)=>x+p.charCodeAt(0),0))%l.length;return e.jsx(t,{className:`badge ${l[c]} hover:opacity-80 transition-opacity`,children:a.name},a.id)})})]}),e.jsxs("div",{className:"text-sm ",children:[s.stats.views_count," vues"]})]})]}),e.jsxs("section",{className:"card bg-base-200 shadow-md p-6 mb-8",children:[e.jsxs("h2",{className:"text-xl font-bold mb-6",children:["Commentaires (",s.all_comments_count,")"]}),n.user&&e.jsx(y,{postId:s.id}),!n.user&&e.jsx("div",{className:"relative mb-5 h-12",children:e.jsx("textarea",{type:"text",readOnly:!0,defaultValue:"Connectez - vous pour placer un commentaire",className:"textarea textarea-error w-full p-3 pr-16 border rounded-lg resize-none transition-all absolute top-0 left-0",rows:"2"})}),e.jsx("div",{className:"space-y-6 mt-6",children:i==null?void 0:i.map(a=>e.jsx(b,{comment:a,auth:n},a.id))}),s.all_comments_count>3&&!r&&e.jsxs("button",{onClick:()=>u(!0),className:"btn btn-link mt-4",children:["Voir tous les commentaires (",s.all_comments_count,")"]})]})]}),e.jsx("div",{className:"lg:w-1/3",children:e.jsxs("div",{className:"sticky top-4 space-y-6",children:[s.related_posts.length>0&&e.jsxs("div",{className:"card bg-base-200 shadow-md p-6",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Articles similaires"}),e.jsx("div",{className:"space-y-4",children:(h=s.related_posts)==null?void 0:h.map(a=>{var l;return e.jsxs(t,{href:route("posts.show",a.slug),className:"block group",children:[e.jsxs("div",{className:"flex gap-3",children:[a.image&&e.jsx("div",{className:"w-20 h-20 flex-shrink-0 rounded overflow-hidden",children:e.jsx("img",{src:a.image,alt:a.title,className:"w-full h-full object-cover"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold group-hover:text-primary transition",children:a.title}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("div",{className:"avatar",children:e.jsx("div",{className:"w-6 rounded-full",children:e.jsx("img",{src:a.author.avatar||`https://ui-avatars.com/api/?name=${a.author.name}`,alt:a.author.name})})}),e.jsx("span",{className:"text-sm text-gray-600",children:a.author.name})]})]})]}),e.jsx("div",{className:"flex gap-1 mt-1",children:(l=a.tags)==null?void 0:l.map(c=>e.jsxs("div",{className:"badge badge-xs badge-info",children:["#",c.name]},c.id))})]},a.id)})})]}),e.jsxs("div",{className:"card bg-base-200 shadow-md p-6",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"À propos de l'auteur"}),e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("div",{className:"avatar",children:e.jsx("div",{className:"w-16 rounded-full",children:e.jsx("img",{src:s.author.avatar||`https://ui-avatars.com/api/?name=${s.author.name}`,alt:s.author.name})})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold",children:s.author.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["@",s.author.username]})]})]}),s.author.bio&&e.jsx("p",{className:"text-opacity-1",children:s.author.bio}),e.jsx(t,{href:route("users.show",s.author.username),className:"btn btn-outline btn-sm mt-4",children:"Voir le profil"})]})]})})]})})]})}export{R as default};
